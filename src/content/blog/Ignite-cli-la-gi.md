---
external: false
draft: false
title: Ignite CLI l√† g√¨?
description: T√¨m hi·ªÉu v·ªÅ Ignite CLI - c√¥ng c·ª• ph√°t tri·ªÉn nhanh blockchain ·ª©ng d·ª•ng d·ª±a tr√™n Cosmos SDK.
date: 2022-11-22
hashtags: ['blockchain']
---

```js title="my-test-file.js"
console.log('Title attribute example')
```

```html
<!-- src/content/index.html -->
<div>File name comment example</div>
```

- **Ignite CLI** (tr∆∞·ªõc ƒë√¢y g·ªçi l√† Starport) l√† m·ªôt c√¥ng c·ª• d√≤ng l·ªánh (**CLI**) h·ªó tr·ª£ ph√°t tri·ªÉn nhanh c√°c blockchain ·ª©ng d·ª•ng d·ª±a tr√™n **Cosmos SDK**.
- N√≥ cung c·∫•p m·ªôt m√¥i tr∆∞·ªùng scaffold m·∫°nh m·∫Ω, gi√∫p nh√† ph√°t tri·ªÉn t·∫≠p trung v√†o logic ·ª©ng d·ª•ng m√† kh√¥ng c·∫ßn lo l·∫Øng qu√° nhi·ªÅu v·ªÅ c·∫•u tr√∫c c∆° b·∫£n c·ªßa blockchain.
- Ignite CLI b·ªï sung v√† c·∫£i ti·∫øn CLI m·∫∑c ƒë·ªãnh c·ªßa Cosmos SDK, gi√∫p t·ª± ƒë·ªông h√≥a nhi·ªÅu quy tr√¨nh ph√°t tri·ªÉn.

---

### **C√°c t√≠nh nƒÉng n·ªïi b·∫≠t c·ªßa Ignite CLI**

1. **Scaffold nhanh**:
    - T·∫°o nhanh m·ªôt blockchain m·ªõi ho·∫∑c c√°c module b√™n trong blockchain.
    - T√≠ch h·ª£p c·∫•u tr√∫c s·∫µn s√†ng ƒë·ªÉ ph√°t tri·ªÉn.
2. **Qu·∫£n l√Ω code t·ª± ƒë·ªông**:
    - T·ª± ƒë·ªông t·∫°o c√°c file li√™n quan ƒë·∫øn module, message, query.
    - Qu·∫£n l√Ω c·∫•u tr√∫c blockchain theo chu·∫©n Cosmos SDK.
3. **T√≠ch h·ª£p ph√°t tri·ªÉn**:
    - H·ªó tr·ª£ **hot reload** khi ph√°t tri·ªÉn blockchain.
    - Ch·∫°y node blockchain v√† k·∫øt n·ªëi v·ªõi m·∫°ng c·ª•c b·ªô.
4. **T∆∞∆°ng th√≠ch v·ªõi Cosmos SDK**:
    - D·ª±a tr√™n c·∫•u tr√∫c v√† kh·∫£ nƒÉng m·ªü r·ªông c·ªßa Cosmos SDK.
    - H·ªó tr·ª£ t∆∞∆°ng t√°c v·ªõi c√°c module chu·∫©n nh∆∞ `bank`, `auth`, `staking`, v.v.
5. **C√¥ng c·ª• CLI ƒë∆°n gi·∫£n**:
    - Cung c·∫•p c√°c l·ªánh d·ªÖ s·ª≠ d·ª•ng ƒë·ªÉ scaffold module, message, query.
6. **T√≠ch h·ª£p gRPC v√† REST API**:
    - T·ª± ƒë·ªông m·ªü c√°c endpoint API ƒë·ªÉ d·ªÖ d√†ng t√≠ch h·ª£p v·ªõi c√°c ·ª©ng d·ª•ng front-end.

---

### **C√°c l·ªánh th∆∞·ªùng g·∫∑p trong Ignite CLI**

### **1. Scaffold blockchain**

T·∫°o m·ªôt d·ª± √°n blockchain m·ªõi.

```bash
ignite scaffold chain <t√™n_blockchain>
```

### **2. Scaffold module**

T·∫°o m·ªôt module m·ªõi trong blockchain.

```bash
ignite scaffold module <t√™n_module>
```

### **3. Scaffold message**

Th√™m m·ªôt message ƒë·ªÉ x·ª≠ l√Ω logic giao d·ªãch trong blockchain.

```bash
ignite scaffold message <t√™n_message> <tham_s·ªë_1> <tham_s·ªë_2> ...
```

V√≠ d·ª•:

```bash
ignite scaffold message say-hello name
```

### **4. Scaffold query**

Th√™m m·ªôt query ƒë·ªÉ l·∫•y d·ªØ li·ªáu t·ª´ blockchain.

```bash
ignite scaffold query <t√™n_query> <tham_s·ªë>
```

V√≠ d·ª•:

```bash
ignite scaffold query get-hello name
```

### **5. Ch·∫°y blockchain**

Build v√† kh·ªüi ch·∫°y node blockchain c·ª•c b·ªô.

```bash
ignite chain serve
```

### **6. Th√™m giao di·ªán ng∆∞·ªùi d√πng**

T√≠ch h·ª£p front-end UI cho blockchain (n·∫øu c√≥).

```bash
ignite scaffold vuex
```

### **7. Ki·ªÉm tra phi√™n b·∫£n**

Xem phi√™n b·∫£n Ignite CLI ƒëang s·ª≠ d·ª•ng.

```bash
ignite version
```

### **8. Th√™m c√°c th√†nh ph·∫ßn kh√°c**

- **Scaffold type**: Th√™m type t√πy ch·ªânh.
    
    ```bash
    ignite scaffold type <t√™n_type> <field_1> <field_2>
    ```
    
- **Scaffold event**: T·∫°o event ƒë·ªÉ ph√°t h√†nh s·ª± ki·ªán trong blockchain.
    
    ```bash
    ignite scaffold event <t√™n_event>
    ```
    

# C·∫•u tr√∫c th∆∞ m·ª•c Cosmos SDK

### **1. `/app`**

- ƒê√¢y l√† th∆∞ m·ª•c ch·ª©a t·ªáp **entry point ch√≠nh** c·ªßa blockchain.
- File quan tr·ªçng nh·∫•t: `app.go`.

### **`app.go`**

- ƒê·ªãnh nghƒ©a **c·∫•u tr√∫c c·ªßa ·ª©ng d·ª•ng blockchain**.
- C√°c th√†nh ph·∫ßn ch√≠nh trong `app.go`:
    - **Module Manager**: Qu·∫£n l√Ω c√°c module (auth, bank, staking, etc.).
    - **Codec**: ƒê·ªãnh nghƒ©a c√°ch m√£ h√≥a v√† gi·∫£i m√£ d·ªØ li·ªáu.
    - **Routing**: X√°c ƒë·ªãnh logic x·ª≠ l√Ω giao d·ªãch (g·ª≠i, staking, voting).
    - **BeginBlocker & EndBlocker**: Logic ch·∫°y ·ªü ƒë·∫ßu v√† cu·ªëi m·ªói kh·ªëi.
    - **Genesis State**: ƒê·ªãnh nghƒ©a tr·∫°ng th√°i kh·ªüi t·∫°o c·ªßa blockchain.

### **V√≠ d·ª• code** (m·ªôt ph·∫ßn c·ªßa `app.go`):

```go
func NewApp(...) *App {
    // Kh·ªüi t·∫°o codec
    codec := MakeCodec()

    // Module Manager qu·∫£n l√Ω module
    moduleManager := module.NewManager(
        auth.NewAppModule(...),
        bank.NewAppModule(...),
        staking.NewAppModule(...),
    )

    // Router ƒë·ªãnh tuy·∫øn giao d·ªãch
    router := baseapp.NewRouter()
    router.AddRoute(bank.RouterKey, bankHandler)

    return &App{
        BaseApp: baseapp.NewBaseApp(...),
        Codec:   codec,
        ModuleManager: moduleManager,
    }

```

---

### **2. `/cmd`**

- Ch·ª©a c√°c l·ªánh CLI ƒë·ªÉ ch·∫°y v√† qu·∫£n l√Ω blockchain.

### C√°c t·ªáp ch√≠nh:

1. **`main.go`**:
    - Entry point kh·ªüi ƒë·ªông ·ª©ng d·ª•ng.
    - Ch·ª©a h√†m `main()` ƒë·ªÉ ch·∫°y node blockchain ho·∫∑c client CLI.
    
    **V√≠ d·ª•**:
    
    ```go
    func main() {
        rootCmd := cmd.NewRootCmd()
        if err := rootCmd.Execute(); err != nil {
            os.Exit(1)
        }
    }
    
    ```
    
2. **`root.go`**:
    - ƒê·ªãnh nghƒ©a c√°c l·ªánh ch√≠nh (CLI command), v√≠ d·ª•:
        - `start`: Ch·∫°y node blockchain.
        - `init`: Kh·ªüi t·∫°o chain v·ªõi t·ªáp `genesis.json`.
        - `keys`: Qu·∫£n l√Ω t√†i kho·∫£n v√† kh√≥a c√° nh√¢n.
        - `query`: Truy v·∫•n d·ªØ li·ªáu blockchain.

---

### **3. `/x`**

- Th∆∞ m·ª•c **module** ‚Äì ph·∫ßn quan tr·ªçng nh·∫•t ƒë·ªÉ m·ªü r·ªông blockchain.
- C√°c module ch·ª©a logic ri√™ng (g·ª≠i ti·ªÅn, staking, governance, v.v.).
- **`/x/<module_name>`**: M·ªói module c√≥ c·∫•u tr√∫c ri√™ng.

### C·∫•u tr√∫c th∆∞ m·ª•c module:

```
/x/<module_name>
    ‚îú‚îÄ‚îÄ keeper/
    ‚îÇ   ‚îî‚îÄ‚îÄ keeper.go     // Logic x·ª≠ l√Ω d·ªØ li·ªáu c·ªßa module
    ‚îú‚îÄ‚îÄ types/
    ‚îÇ   ‚îú‚îÄ‚îÄ keys.go       // ƒê·ªãnh nghƒ©a c√°c kh√≥a d·ªØ li·ªáu
    ‚îÇ   ‚îú‚îÄ‚îÄ messages.go   // ƒê·ªãnh nghƒ©a c√°c lo·∫°i message (Msg)
    ‚îÇ   ‚îî‚îÄ‚îÄ params.go     // Tham s·ªë module (config)
    ‚îú‚îÄ‚îÄ genesis.go        // Logic kh·ªüi t·∫°o module
    ‚îú‚îÄ‚îÄ handler.go        // X·ª≠ l√Ω transaction (Msg)
    ‚îú‚îÄ‚îÄ module.go         // ƒêƒÉng k√Ω module v√†o Cosmos SDK
    ‚îî‚îÄ‚îÄ query.proto       // API gRPC ƒë·ªÉ query d·ªØ li·ªáu
```

### **Ch·ª©c nƒÉng t·ª´ng file trong m·ªôt module:**

- **`keeper/keeper.go`**:
    - Ch·ª©a c√°c h√†m ƒë·ªÉ ƒë·ªçc/ghi d·ªØ li·ªáu t·ª´ b·ªô nh·ªõ blockchain (store).
    - Keeper gi·ªëng nh∆∞ "b·ªô qu·∫£n l√Ω" d·ªØ li·ªáu.
    
    **V√≠ d·ª•**:
    
    ```go
    func (k Keeper) GetBalance(ctx sdk.Context, addr sdk.AccAddress) sdk.Coin {
        return k.store.GetBalance(addr)
    }
    ```
    
- **`types/`**:
    - Ch·ª©a ƒë·ªãnh nghƒ©a c√°c ki·ªÉu d·ªØ li·ªáu, th√¥ng b√°o (Msg), v√† tham s·ªë c·ªßa module.
    - **Msg**: C√°c giao d·ªãch trong module.
    - **Params**: C√°c c·∫•u h√¨nh, v√≠ d·ª• nh∆∞ ph√≠ giao d·ªãch t·ªëi thi·ªÉu.
- **`genesis.go`**:
    - ƒê·ªãnh nghƒ©a tr·∫°ng th√°i ban ƒë·∫ßu khi blockchain kh·ªüi ch·∫°y (Genesis State).
- **`module.go`**:
    - Giao di·ªán gi·ªØa module v√† Cosmos SDK.
    - X√°c ƒë·ªãnh c√°c h√†m nh∆∞:
        - `InitGenesis`: Kh·ªüi t·∫°o tr·∫°ng th√°i ban ƒë·∫ßu.
        - `ExportGenesis`: L∆∞u tr·∫°ng th√°i ƒë·ªÉ kh·ªüi ƒë·ªông l·∫°i chain.
- **`handler.go`**:
    - Logic x·ª≠ l√Ω c√°c giao d·ªãch c·ªßa module (MsgHandler).

---

### **4. `/config`**

- Ch·ª©a c√°c t·ªáp c·∫•u h√¨nh blockchain.
- **C√°c file quan tr·ªçng**:
    - `app.toml`: C·∫•u h√¨nh node (ƒë·ªìng thu·∫≠n, t·ªëc ƒë·ªô kh·ªëi, etc.).
    - `config.toml`: C·∫•u h√¨nh m·∫°ng (c·ªïng giao ti·∫øp, P2P).
    - `genesis.json`: Tr·∫°ng th√°i ban ƒë·∫ßu c·ªßa blockchain.

---

### **5. `/proto`**

- ƒê·ªãnh nghƒ©a c√°c t·ªáp **Protocol Buffers (protobuf)** ƒë·ªÉ sinh code cho gRPC v√† REST API.
- C√°c file `.proto` m√¥ t·∫£ c·∫•u tr√∫c d·ªØ li·ªáu, request, v√† response c·ªßa blockchain.

---

### **6. `/testutil`**

- Ch·ª©a c√°c ti·ªán √≠ch ƒë·ªÉ ki·ªÉm th·ª≠ blockchain.
- G·ªìm c√°c test case (unit test, integration test) cho module.

---

### **7. `/scripts`**

- Ch·ª©a c√°c script ti·ªán √≠ch, v√≠ d·ª•:
    - Script kh·ªüi t·∫°o node (localnet).
    - Script ƒë·ªÉ reset tr·∫°ng th√°i blockchain.

---

### **8. `/docs`**

- Ch·ª©a t√†i li·ªáu v·ªÅ d·ª± √°n, m√¥ t·∫£ c√°ch s·ª≠ d·ª•ng v√† m·ªü r·ªông blockchain.

---

### **T√≥m t·∫Øt vai tr√≤ c·ªßa t·ª´ng th∆∞ m·ª•c**

| Th∆∞ m·ª•c | Ch·ª©c nƒÉng |
| --- | --- |
| `/app` | Entry point v√† c·∫•u tr√∫c ch√≠nh c·ªßa blockchain. |
| `/cmd` | C√°c l·ªánh CLI ƒë·ªÉ qu·∫£n l√Ω v√† kh·ªüi ch·∫°y blockchain. |
| `/x` | Module logic (m·ªü r·ªông t√≠nh nƒÉng blockchain). |
| `/config` | C√°c t·ªáp c·∫•u h√¨nh cho node v√† m·∫°ng. |
| `/proto` | ƒê·ªãnh nghƒ©a giao di·ªán API (protobuf). |
| `/testutil` | C√°c ti·ªán √≠ch ki·ªÉm th·ª≠. |
| `/scripts` | Script ti·ªán √≠ch cho m√¥i tr∆∞·ªùng ph√°t tri·ªÉn. |
| `/docs` | T√†i li·ªáu m√¥ t·∫£ c√°ch d√πng v√† ph√°t tri·ªÉn blockchain. |

# M·ªôt s·ªë kh√°i ni·ªám c·∫ßn bi·∫øt trong code base Cosmos

# Protobuf l√† g√¨ ?

üí°¬†Source : https://tvd12.com/posts/protobuf

**Protobuf (Protocol Buffers)**¬†l√† m·ªôt c∆° ch·∫ø m√£ h√≥a d·ªØ li·ªáu nh·ªã ph√¢n (binary) do Google ph√°t tri·ªÉn, d√πng ƒë·ªÉ:

1. **ƒê·ªãnh nghƒ©a c·∫•u tr√∫c d·ªØ li·ªáu**¬†(message types) v√†¬†**d·ªãch v·ª•**¬†(services) trong t·ªáp¬†`.proto`.
2. **M√£ h√≥a d·ªØ li·ªáu**¬†th√†nh d·∫°ng nh·ªã ph√¢n nh·ªè g·ªçn, hi·ªáu su·∫•t cao.
3. **Sinh m√£ ngu·ªìn**¬†(code generation) t·ª´ t·ªáp¬†`.proto`¬†sang c√°c ng√¥n ng·ªØ l·∫≠p tr√¨nh nh∆∞ Go, Python, Java, v.v.

---

### **T·∫°i sao d√πng Protobuf?**

1. **Hi·ªáu su·∫•t cao**: D·ªØ li·ªáu nh·ªã ph√¢n nh·ªè g·ªçn h∆°n JSON/XML.
2. **T√≠nh nh·∫•t qu√°n**: Ki·ªÉm so√°t ki·ªÉu d·ªØ li·ªáu ch·∫∑t ch·∫Ω.
3. **H·ªó tr·ª£ ƒëa ng√¥n ng·ªØ**: Sinh m√£ ngu·ªìn cho nhi·ªÅu ng√¥n ng·ªØ.
4. **T√≠ch h·ª£p v·ªõi gRPC**: H·ªó tr·ª£ giao ti·∫øp gi·ªØa c√°c d·ªãch v·ª•.

---

### **V√≠ d·ª•**

### 1.¬†**ƒê·ªãnh nghƒ©a¬†`.proto`**

T·∫°o t·ªáp¬†`person.proto`:

```
syntax = "proto3";

message Person {
  string name = 1;
  int32 age = 2;
  repeated string hobbies = 3;
}
```

### 2.¬†**Sinh m√£ ngu·ªìn**

D√πng¬†`protoc`¬†ƒë·ªÉ sinh m√£ Go:

```
protoc --go_out=. person.proto
```

K·∫øt qu·∫£: T·ªáp¬†`person.pb.go`¬†ƒë∆∞·ª£c sinh ra, ch·ª©a struct¬†`Person`¬†trong Go.

`protoc`¬†s·∫Ω sinh ra t·ªáp¬†`person.pb.go`¬†v·ªõi n·ªôi dung nh∆∞ sau (ƒë√£ r√∫t g·ªçn):

```go
package main

type Person struct {
    Name    string   `protobuf:"bytes,1,opt,name=name,proto3" json:"name,omitempty"`
    Age     int32    `protobuf:"varint,2,opt,name=age,proto3" json:"age,omitempty"`
    Hobbies []string `protobuf:"bytes,3,rep,name=hobbies,proto3" json:"hobbies,omitempty"`
}

func (m *Person) Reset()         { *m = Person{} }
func (m *Person) String() string { return proto.CompactTextString(m) }
func (*Person) ProtoMessage()    {}
```

### 3.¬†**S·ª≠ d·ª•ng trong Go**

T·∫°o t·ªáp¬†`main.go`:

```go
package main

import (
    "fmt"
    "log"
    "github.com/golang/protobuf/proto"
    . "./" // Import struct Person t·ª´ person.pb.go
)

func main() {
    // T·∫°o ƒë·ªëi t∆∞·ª£ng Person
    person := &Person{
        Name:    "John",
        Age:     30,
        Hobbies: []string{"Reading", "Swimming"},
    }

    // M√£ h√≥a th√†nh nh·ªã ph√¢n
    data, err := proto.Marshal(person)
    if err != nil {
        log.Fatal("Encoding failed:", err)
    }

    // In ra d·ªØ li·ªáu nh·ªã ph√¢n (d·∫°ng hex)
    fmt.Printf("Encoded data (hex): %x\n", data)

    // Gi·∫£i m√£ nh·ªã ph√¢n
    newPerson := &Person{}
    err = proto.Unmarshal(data, newPerson)
    if err != nil {
        log.Fatal("Decoding failed:", err)
    }

    // In ra ƒë·ªëi t∆∞·ª£ng ƒë√£ gi·∫£i m√£
    fmt.Println("Decoded person:", newPerson)
}
```

### **C·∫•u tr√∫c th∆∞ m·ª•c**

```
myapp/
‚îú‚îÄ‚îÄ person.proto
‚îú‚îÄ‚îÄ person.pb.go
‚îî‚îÄ‚îÄ main.go
```

### 4.¬†**Ch·∫°y ·ª©ng d·ª•ng**

```
go run main.go person.pb.go
```

---

### **K·∫øt qu·∫£**

Khi ch·∫°y ·ª©ng d·ª•ng, k·∫øt qu·∫£ s·∫Ω nh∆∞ sau:

```
Encoded data (hex): 0a044a6f686e101e1a0752656164696e671a085377696d6d696e67
Decoded person: name:"John" age:30 hobbies:"Reading" hobbies:"Swimming"
```

- **Encoded data (hex)**: D·ªØ li·ªáu nh·ªã ph√¢n c·ªßa ƒë·ªëi t∆∞·ª£ng¬†`Person`¬†ƒë√£ ƒë∆∞·ª£c m√£ h√≥a.
- **Decoded person**: ƒê·ªëi t∆∞·ª£ng¬†`Person`¬†ƒë√£ ƒë∆∞·ª£c gi·∫£i m√£ t·ª´ d·ªØ li·ªáu nh·ªã ph√¢n.

---

### **Gi·∫£i th√≠ch chi ti·∫øt**

### a.¬†**File¬†`person.pb.go`**

- ƒê∆∞·ª£c sinh ra t·ª´¬†`person.proto`¬†b·∫±ng l·ªánh¬†`protoc`.
- Ch·ª©a ƒë·ªãnh nghƒ©a struct¬†`Person`¬†v√† c√°c ph∆∞∆°ng th·ª©c c·∫ßn thi·∫øt ƒë·ªÉ l√†m vi·ªác v·ªõi Protobuf.

### b.¬†**H√†m¬†`proto.Marshal`**

- M√£ h√≥a ƒë·ªëi t∆∞·ª£ng¬†`Person`¬†th√†nh d·ªØ li·ªáu nh·ªã ph√¢n.
- C·∫ßn file¬†`person.pb.go`¬†ƒë·ªÉ bi·∫øt c·∫•u tr√∫c c·ªßa¬†`Person`.

### c.¬†**H√†m¬†`proto.Unmarshal`**

- Gi·∫£i m√£ d·ªØ li·ªáu nh·ªã ph√¢n th√†nh ƒë·ªëi t∆∞·ª£ng¬†`Person`.
- C·∫ßn file¬†`person.pb.go`¬†ƒë·ªÉ bi·∫øt c√°ch t·∫°o ƒë·ªëi t∆∞·ª£ng¬†`Person`.

# **State Machine Replication (SMR) l√† g√¨?**

**State Machine Replication (SMR)**¬†l√† m·ªôt k·ªπ thu·∫≠t cho ph√©p nhi·ªÅu b·∫£n sao (replicas) c·ªßa m·ªôt state machine ho·∫°t ƒë·ªông ƒë·ªìng b·ªô v√† nh·∫•t qu√°n trong m·ªôt h·ªá th·ªëng ph√¢n t√°n. M·ª•c ti√™u ch√≠nh c·ªßa SMR l√†:

1. **ƒê·∫£m b·∫£o t√≠nh nh·∫•t qu√°n**: T·∫•t c·∫£ c√°c b·∫£n sao ph·∫£i c√≥ c√πng state sau khi x·ª≠ l√Ω c√πng m·ªôt chu·ªói c√°c s·ª± ki·ªán (events).
2. **Ch·ªãu l·ªói (Fault Tolerance)**: H·ªá th·ªëng v·∫´n ho·∫°t ƒë·ªông ch√≠nh x√°c ngay c·∫£ khi m·ªôt s·ªë b·∫£n sao b·ªã l·ªói.

---

### **2. C√°c th√†nh ph·∫ßn ch√≠nh c·ªßa State Machine Replication**

### a.¬†**State Machine (M√°y tr·∫°ng th√°i)**

- M·ªôt state machine c√≥ th·ªÉ t·ªìn t·∫°i trong m·ªôt s·ªë tr·∫°ng th√°i (states) h·ªØu h·∫°n v√† chuy·ªÉn ƒë·ªïi gi·ªØa c√°c tr·∫°ng th√°i d·ª±a tr√™n c√°c s·ª± ki·ªán (events).

### b.¬†**Replicas (B·∫£n sao)**

- C√°c b·∫£n sao l√† c√°c phi√™n b·∫£n c·ªßa state machine ch·∫°y tr√™n c√°c node kh√°c nhau trong h·ªá th·ªëng ph√¢n t√°n.

### c.¬†**Consensus Algorithm (Thu·∫≠t to√°n ƒë·ªìng thu·∫≠n)**

- ƒê·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ c√°c b·∫£n sao ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c√°c s·ª± ki·ªán (events) v√† state cu·ªëi c√πng.

---

### **3. C√°ch State Machine Replication ho·∫°t ƒë·ªông**

### a.¬†**Nh·∫≠n v√† x·ª≠ l√Ω s·ª± ki·ªán**

1. Khi m·ªôt s·ª± ki·ªán (event) ƒë∆∞·ª£c g·ª≠i ƒë·∫øn h·ªá th·ªëng, n√≥ s·∫Ω ƒë∆∞·ª£c chuy·ªÉn ƒë·∫øn t·∫•t c·∫£ c√°c b·∫£n sao.
2. C√°c b·∫£n sao s·ª≠ d·ª•ng m·ªôt¬†**thu·∫≠t to√°n ƒë·ªìng thu·∫≠n**¬†(v√≠ d·ª•: Tendermint trong Cosmos SDK) ƒë·ªÉ ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c·ªßa c√°c s·ª± ki·ªán.

### b.¬†**√Åp d·ª•ng s·ª± ki·ªán v√†o state machine**

1. Sau khi th·ª© t·ª± c√°c s·ª± ki·ªán ƒë∆∞·ª£c x√°c ƒë·ªãnh, m·ªói b·∫£n sao s·∫Ω √°p d·ª•ng c√°c s·ª± ki·ªán v√†o state machine c·ªßa n√≥.
2. V√¨ t·∫•t c·∫£ c√°c b·∫£n sao nh·∫≠n c√πng m·ªôt chu·ªói s·ª± ki·ªán v√† √°p d·ª•ng ch√∫ng theo c√πng m·ªôt th·ª© t·ª±, state c·ªßa ch√∫ng s·∫Ω lu√¥n nh·∫•t qu√°n.

### c.¬†**Ch·ªãu l·ªói**

- N·∫øu m·ªôt s·ªë b·∫£n sao b·ªã l·ªói, c√°c b·∫£n sao c√≤n l·∫°i v·∫´n c√≥ th·ªÉ ti·∫øp t·ª•c ho·∫°t ƒë·ªông v√† duy tr√¨ t√≠nh nh·∫•t qu√°n c·ªßa h·ªá th·ªëng.

---

### **4. V√≠ d·ª• v·ªÅ State Machine Replication**

Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt h·ªá th·ªëng v·ªõi 3 b·∫£n sao (Replica A, Replica B, Replica C) v√† m·ªôt state machine qu·∫£n l√Ω s·ªë d∆∞ t√†i kho·∫£n.

### a.¬†**State ban ƒë·∫ßu**

- T√†i kho·∫£n X: 100 token
- T√†i kho·∫£n Y: 50 token

### b.¬†**S·ª± ki·ªán**

- X g·ª≠i 10 token cho Y.

### c.¬†**X·ª≠ l√Ω s·ª± ki·ªán**

1. S·ª± ki·ªán ƒë∆∞·ª£c g·ª≠i ƒë·∫øn t·∫•t c·∫£ c√°c b·∫£n sao.
2. C√°c b·∫£n sao s·ª≠ d·ª•ng thu·∫≠t to√°n ƒë·ªìng thu·∫≠n ƒë·ªÉ ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c·ªßa s·ª± ki·ªán.
3. M·ªói b·∫£n sao √°p d·ª•ng s·ª± ki·ªán v√†o state machine c·ªßa n√≥:
    - Tr·ª´ 10 token t·ª´ t√†i kho·∫£n X.
    - C·ªông 10 token v√†o t√†i kho·∫£n Y.

### d.¬†**State m·ªõi**

- T√†i kho·∫£n X: 90 token
- T√†i kho·∫£n Y: 60 token

---

### **5. State Machine Replication trong Blockchain**

Blockchain l√† m·ªôt ·ª©ng d·ª•ng ƒëi·ªÉn h√¨nh c·ªßa State Machine Replication:

- **State**: D·ªØ li·ªáu hi·ªán t·∫°i c·ªßa blockchain (v√≠ d·ª•: s·ªë d∆∞ t√†i kho·∫£n, h·ª£p ƒë·ªìng th√¥ng minh).
- **Transactions**: C√°c s·ª± ki·ªán l√†m thay ƒë·ªïi state.
- **Consensus Algorithm**: ƒê·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ c√°c node ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c·ªßa c√°c transactions.

### V√≠ d·ª• trong Cosmos SDK:

- **Tendermint**: Thu·∫≠t to√°n ƒë·ªìng thu·∫≠n ƒë∆∞·ª£c s·ª≠ d·ª•ng trong Cosmos SDK ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ c√°c node ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c·ªßa c√°c transactions.
- **Modules**: M·ªói module (v√≠ d·ª•:¬†`bank`,¬†`staking`) l√† m·ªôt state machine ƒë·ªôc l·∫≠p, ƒë∆∞·ª£c qu·∫£n l√Ω b·ªüi c√°c Keepers.

---

### **6. V√≠ d·ª• c·ª• th·ªÉ trong Cosmos SDK**

Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt blockchain v·ªõi module¬†`bank`¬†ƒë·ªÉ qu·∫£n l√Ω s·ªë d∆∞ t√†i kho·∫£n.

### a.¬†**State ban ƒë·∫ßu**

- T√†i kho·∫£n A: 100 token
- T√†i kho·∫£n B: 50 token

### b.¬†**Transaction**

- A g·ª≠i 10 token cho B.

### c.¬†**X·ª≠ l√Ω transaction**

1. Transaction ƒë∆∞·ª£c g·ª≠i ƒë·∫øn blockchain.
2. Tendermint Core s·ª≠ d·ª•ng thu·∫≠t to√°n ƒë·ªìng thu·∫≠n ƒë·ªÉ ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c·ªßa transaction.
3. Transaction ƒë∆∞·ª£c √°p d·ª•ng v√†o state machine:
    - Handler c·ªßa module¬†`bank`¬†g·ªçi Keeper ƒë·ªÉ c·∫≠p nh·∫≠t state.
    - Keeper tr·ª´ 10 token t·ª´ t√†i kho·∫£n A v√† c·ªông 10 token v√†o t√†i kho·∫£n B.

### d.¬†**State m·ªõi**

- T√†i kho·∫£n A: 90 token
- T√†i kho·∫£n B: 60 token

---

### **7. T√≥m l·∫°i**

- **State Machine Replication (SMR)**¬†l√† m·ªôt k·ªπ thu·∫≠t ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng nhi·ªÅu b·∫£n sao c·ªßa m·ªôt state machine c√≥ th·ªÉ duy tr√¨ tr·∫°ng th√°i nh·∫•t qu√°n trong h·ªá th·ªëng ph√¢n t√°n.
- Trong blockchain, SMR ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ƒë·∫£m b·∫£o r·∫±ng t·∫•t c·∫£ c√°c node ƒë·ªìng √Ω v·ªÅ th·ª© t·ª± c·ªßa c√°c transactions v√† state cu·ªëi c√πng.
- **Cosmos SDK**¬†s·ª≠ d·ª•ng SMR k·∫øt h·ª£p v·ªõi thu·∫≠t to√°n ƒë·ªìng thu·∫≠n Tendermint ƒë·ªÉ x√¢y d·ª±ng c√°c ·ª©ng d·ª•ng blockchain an to√†n v√† nh·∫•t qu√°n.

# **C√°c module m·∫∑c ƒë·ªãnh c·ªßa Cosmos SDK**

Cosmos SDK cung c·∫•p nhi·ªÅu¬†**module m·∫∑c ƒë·ªãnh**¬†ƒë·ªÉ x√¢y d·ª±ng c√°c ·ª©ng d·ª•ng blockchain. D∆∞·ªõi ƒë√¢y l√† m·ªôt s·ªë module quan tr·ªçng:

### **3.1.¬†`auth`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω t√†i kho·∫£n v√† x√°c th·ª±c giao d·ªãch.
- **Chi ti·∫øt**:
    - ƒê·ªãnh nghƒ©a c·∫•u tr√∫c t√†i kho·∫£n (`BaseAccount`).
    - X√°c th·ª±c ch·ªØ k√Ω v√† qu·∫£n l√Ω ph√≠ giao d·ªãch.

### **3.2.¬†`bank`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω s·ªë d∆∞ token v√† chuy·ªÉn token gi·ªØa c√°c t√†i kho·∫£n.
- **Chi ti·∫øt**:
    - Cung c·∫•p c√°c message types nh∆∞¬†`MsgSend`,¬†`MsgMultiSend`.
    - Qu·∫£n l√Ω t·ªïng cung token.

### **3.3.¬†`staking`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω staking (ƒë·∫∑t c·ªçc) v√† validators.
- **Chi ti·∫øt**:
    - Cho ph√©p ng∆∞·ªùi d√πng stake token ƒë·ªÉ tr·ªü th√†nh validator.
    - Qu·∫£n l√Ω ph·∫ßn th∆∞·ªüng v√† ph·∫°t (slashing) cho validators.

### **3.4.¬†`distribution`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω ph√¢n ph·ªëi ph·∫ßn th∆∞·ªüng t·ª´ staking v√† ph√≠ giao d·ªãch.
- **Chi ti·∫øt**:
    - Ph√¢n ph·ªëi ph·∫ßn th∆∞·ªüng cho validators v√† delegators.
    - Qu·∫£n l√Ω qu·ªπ c·ªông ƒë·ªìng (community pool).

### **3.5.¬†`gov`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω qu·∫£n tr·ªã on-chain (on-chain governance).
- **Chi ti·∫øt**:
    - Cho ph√©p ng∆∞·ªùi d√πng ƒë·ªÅ xu·∫•t v√† b·ªè phi·∫øu cho c√°c thay ƒë·ªïi tr√™n blockchain.
    - Qu·∫£n l√Ω c√°c ƒë·ªÅ xu·∫•t v√† k·∫øt qu·∫£ b·ªè phi·∫øu.

### **3.6.¬†`mint`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω vi·ªác ƒë√∫c (mint) token m·ªõi.
- **Chi ti·∫øt**:
    - ƒê√∫c token m·ªõi d·ª±a tr√™n c√°c quy t·∫Øc l·∫°m ph√°t ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr∆∞·ªõc.
    - Ph√¢n ph·ªëi token m·ªõi cho c√°c validators v√† delegators.

### **3.7.¬†`params`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω c√°c tham s·ªë (parameters) c·ªßa blockchain.
- **Chi ti·∫øt**:
    - Cho ph√©p thay ƒë·ªïi c√°c tham s·ªë nh∆∞ ph√≠ giao d·ªãch, t·ª∑ l·ªá l·∫°m ph√°t, v.v.

### **3.8.¬†`crisis`**

- **Ch·ª©c nƒÉng**: Ph√°t hi·ªán v√† x·ª≠ l√Ω c√°c t√¨nh hu·ªëng kh·ªßng ho·∫£ng (crisis) tr√™n blockchain.
- **Chi ti·∫øt**:
    - Cung c·∫•p c∆° ch·∫ø ƒë·ªÉ ph√°t hi·ªán v√† x·ª≠ l√Ω c√°c l·ªói nghi√™m tr·ªçng.

### **3.9.¬†`evidence`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω c√°c b·∫±ng ch·ª©ng (evidence) v·ªÅ h√†nh vi x·∫•u c·ªßa validators.
- **Chi ti·∫øt**:
    - X·ª≠ l√Ω c√°c b·∫±ng ch·ª©ng nh∆∞ double-sign v√† ph·∫°t validators vi ph·∫°m.

### **3.10.¬†`upgrade`**

- **Ch·ª©c nƒÉng**: Qu·∫£n l√Ω n√¢ng c·∫•p (upgrade) blockchain.
- **Chi ti·∫øt**:
    - Cho ph√©p n√¢ng c·∫•p ph·∫ßn m·ªÅm blockchain m√† kh√¥ng c·∫ßn hard fork.

# **C√°c b∆∞·ªõc t·∫°o m·ªôt module m·ªõi trong Cosmos SDK**